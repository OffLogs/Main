@using QRID.Mail.UI.Shared.Layout;
@using QRID.Mail.UI.Shared.Layout.Navigation.Models

<div class="w-sub-menu-container">
    <Header Buttons="@Buttons"/>
    <div class="w-sub-menu">
        <ul>
            @if (MenuItems != null)
            {
                @foreach (var menuItem in MenuItems)
                {
                    <li 
                        @onclick="@(() => OnSelectMenuItem(menuItem))" 
                        class="@(IsSelected(menuItem) ? "w-selected" : "")"
                    >
                        <span class="w-title">
                            @menuItem.Title
                        </span>
                        <span class="w-title-2">
                            @menuItem.RightTitle
                        </span>
                        <span class="w-sub-title">
                            @menuItem.SubTitle
                        </span>
                    </li>
                }    
            }
        </ul>
    </div>
</div>

@code {

    [CascadingParameter(Name = "Layout")]
    public NavigationLayout Layout { get; set; }

    [Parameter]
    public SubMenuItem SelectedItem { get; set; }

    [Parameter]
    public List<SubMenuItem> MenuItems { get; set; }

    [Parameter]
    public ICollection<HeaderMenuButton> Buttons { get; set; } = new List<HeaderMenuButton>();

    protected override Task OnInitializedAsync()
    {
        Buttons.Add(
            new HeaderMenuButton("Select", "check-alt")
        );
        return Task.CompletedTask;
    }

    public void OnSelectMenuItem(SubMenuItem menuItem)
    {
        Layout.OnSelectSubMenuItem(menuItem);
    }

    public bool IsSelected(SubMenuItem menuItem)
    {
        return SelectedItem?.Id == menuItem.Id;
    }
}
