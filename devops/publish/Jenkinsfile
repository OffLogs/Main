node('master') {
    stage('Checkout') {
        checkout scm
        sh 'ls -sh'
    }
    
    stage('Build Docker image') {
        sh 'docker build --tag="offlogs-production-web" --file="devops/publish/Dockerfile" .'
        sh 'docker save -o test.tar offlogs-production-web'
    }
    
    stage('Publish stash') {
        stash 'target', includes: "**/*.tar"
    }
}
node('production') {
    stage('Unstash') {
        unstash 'target'
        sh 'ls -sh'
    }

    stage('Run') {
        
    }
}
